<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XZYO STORE - LIVE</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { background: #0b1220; color: white; font-family: sans-serif; text-align: center; }
        .card { background: #111a33; padding: 20px; border-radius: 15px; margin: 10px auto; max-width: 500px; border: 1px solid #333; }
        input { width: 90%; padding: 10px; margin: 5px; border-radius: 5px; border: none; }
        button { width: 95%; padding: 12px; background: #0072ff; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: bold; }
        .item { display: flex; justify-content: space-between; padding: 10px; border-bottom: 1px solid #222; }
    </style>
</head>
<body>

    <h2>XZYO STORE LEADERBOARD</h2>

    <div id="adminBox" class="card" style="display:none;">
        <input type="text" id="nama" placeholder="Nama Sultan">
        <input type="number" id="nominal" placeholder="Nominal (Angka)">
        <button id="btnSimpan">UPDATE DATA SEKARANG</button>
    </div>

    <div class="card">
        <div id="listData">Memuat data...</div>
    </div>

<script>
    // Data Firebase Rahmat
    const firebaseConfig = {
        apiKey: "AIzaSyC6aUjN60bSDE0BLVs3V-yNRYfSsPv0ZV8",
        authDomain: "xzyostore-66448.firebaseapp.com",
        databaseURL: "https://xzyostore-66448-default-rtdb.firebaseio.com",
        projectId: "xzyostore-66448",
        storageBucket: "xzyostore-66448.firebasestorage.app",
        appId: "1:547146618223:web:978b8956cc0293cfb7449a"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    if(window.location.search.includes('admin=true')) {
        document.getElementById('adminBox').style.display = 'block';
    }

    // Fungsi Klik Tombol
    document.getElementById('btnSimpan').onclick = function() {
        const n = document.getElementById('nama').value;
        const p = parseInt(document.getElementById('nominal').value);
        
        if(!n || !p) return alert("Isi dulu lek!");

        db.ref('sultan/' + n).once('value').then((s) => {
            const d = s.val() || { total: 0 };
            db.ref('sultan/' + n).update({ total: d.total + p }).then(() => {
                alert("Berhasil Masuk!");
                document.getElementById('nominal').value = "";
            });
        });
    };

    // Baca Data
    db.ref('sultan').on('value', (s) => {
        const container = document.getElementById('listData');
        const data = s.val();
        if(!data) return container.innerHTML = "Kosong lek.";
        
        container.innerHTML = "";
        Object.keys(data).sort((a,b) => data[b].total - data[a].total).forEach((name, i) => {
            container.innerHTML += `<div class="item"><span>${i+1}. ${name}</span> <b>Rp ${data[name].total.toLocaleString()}</b></div>`;
        });
    });
</script>
</body>
</html>
